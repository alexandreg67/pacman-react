/* CSS Optimisé pour Performance - Pacman Game */

/* Import des styles rétro-gaming */
@import './styles/retro.css';

/* Variables de base simplifiées */
:root {
  --wall-color: #2563eb;
  --wall-border: #1e40af;
  --path-color: #000000;
  --pellet-color: #fbbf24;
  --power-pellet-color: #f59e0b;
}

#root {
  margin: 0;
  padding: 0;
  min-height: 100vh;
  width: 100%;
}

/* ===== SYSTÈME DE MURS OPTIMISÉ ===== */

.maze-container {
  contain: layout style paint;
  overflow: hidden;
  /* Optimisation GPU */
  will-change: auto;
  transform: translateZ(0);
}

.wall-segment {
  background: var(--wall-color);
  border: 1px solid var(--wall-border);
  position: relative;

  /* Optimisation GPU forcée */
  transform: translateZ(0);
  will-change: auto;

  /* Shadow simple mais efficace */
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}

/* ===== CHEMINS ET PELLETS OPTIMISÉS ===== */

.path-segment {
  background: var(--path-color);
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  /* Optimisation containment */
  contain: layout style;
}

.pellet-dot {
  width: 4px;
  height: 4px;
  border-radius: 50%;
  background: var(--pellet-color);
  box-shadow: 0 0 4px rgba(251, 191, 36, 0.6);
  /* Optimisation GPU */
  transform: translateZ(0);
}

.power-pellet {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: radial-gradient(circle at 30% 30%, #fff 0%, var(--power-pellet-color) 70%);
  box-shadow: 0 0 8px rgba(245, 158, 11, 0.8);
  /* Animation simple */
  animation: power-pellet-pulse 1s ease-in-out infinite;
  /* Optimisation GPU */
  transform: translateZ(0);
}

@keyframes power-pellet-pulse {
  0%,
  100% {
    transform: scale(1) translateZ(0);
    opacity: 1;
  }
  50% {
    transform: scale(1.1) translateZ(0);
    opacity: 0.8;
  }
}

/* ===== PACMAN OPTIMISÉ ===== */

.pacman-container {
  /* Optimisation GPU pour les animations de position */
  will-change: transform;
  transform: translateZ(0);
  /* Shadow simple */
  filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3));
}

/* ===== RESPONSIVE DESIGN SIMPLIFIÉ ===== */

@media (max-width: 768px) {
  .wall-segment {
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
  }

  .pellet-dot {
    width: 3px;
    height: 3px;
  }

  .power-pellet {
    width: 9px;
    height: 9px;
  }
}

/* ===== ACCESSIBILITÉ ===== */

@media (prefers-reduced-motion: reduce) {
  .power-pellet {
    animation: none !important;
  }

  .pacman-container {
    transition: none !important;
  }

  /* Désactiver toutes les animations pour l'accessibilité */
  * {
    animation-duration: 0.01s !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01s !important;
    scroll-behavior: auto !important;
  }

  /* Désactiver spécifiquement glow-pulse et autres animations du GameOver */
  .animate-glow-pulse,
  .animate-pulse,
  .animate-bounce,
  .animate-ping {
    animation: none !important;
  }

  /* Maintenir les transformations de base sans animation */
  .hover\:scale-105:hover {
    transform: scale(1) !important;
    transition: none !important;
  }

  /* Désactiver les box-shadows animées */
  @keyframes glow-pulse {
    0%,
    100% {
      box-shadow: 0 0 20px 4px currentColor;
    }
  }
}

@media (prefers-contrast: high) {
  :root {
    --wall-color: #0066ff;
    --wall-border: #ffffff;
  }

  .wall-segment {
    border: 2px solid #ffffff;
  }

  .pellet-dot,
  .power-pellet {
    border: 1px solid #ffffff;
  }

  /* Améliorer le contraste pour le GameOver screen */
  .text-slate-400 {
    color: #cbd5e1 !important; /* Contraste ratio amélioré */
  }

  .text-slate-300 {
    color: #e2e8f0 !important; /* Contraste ratio amélioré */
  }

  /* Focus ring plus visible */
  button:focus {
    outline: 3px solid #ffffff !important;
    outline-offset: 2px !important;
  }

  /* Améliorer les couleurs des touches kbd */
  kbd {
    background: #1e293b !important;
    color: #f1f5f9 !important;
    border: 2px solid #ffffff !important;
  }
}

/* ===== STYLES D'INTERACTION ===== */

kbd {
  background: linear-gradient(135deg, #4a5568, #2d3748);
  border: 1px solid #4a5568;
  border-bottom: 2px solid #2d3748;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
  font-size: 0.8rem;
  font-weight: 600;
  padding: 2px 6px;
  border-radius: 3px;
}

/* ===== OPTIMISATIONS DE PERFORMANCE GLOBALES ===== */

/* Containment pour tous les éléments de jeu */
.maze-container,
.wall-segment,
.path-segment,
.pacman-container {
  contain: layout style paint;
}

/* Optimisation GPU pour les éléments animés */
.pacman-container,
.power-pellet {
  transform: translateZ(0);
  backface-visibility: hidden;
}

/* ===== GHOST VISUALS ===== */
.ghost-body {
  will-change: transform, filter;
}

@keyframes ghost-bob {
  0%,
  100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-1px);
  }
}

/* Apply gentle bobbing only when not prefers-reduced-motion */
@media (prefers-reduced-motion: no-preference) {
  .ghost-body {
    animation: ghost-bob 0.8s ease-in-out infinite;
  }
}

/* Frightened flashing enhancement */
@keyframes ghost-flash {
  0%,
  100% {
    filter: none;
  }
  50% {
    filter: brightness(1.3) saturate(1.2);
  }
}

.ghost-frightened.ghost-flash {
  animation:
    ghost-bob 0.8s ease-in-out infinite,
    ghost-flash 0.4s steps(2, end) infinite;
}

/* ===== GAME OVER SCREEN ANIMATIONS ===== */
@keyframes glow-pulse {
  0%,
  100% {
    box-shadow:
      0 0 40px 12px currentColor,
      0 0 80px 20px currentColor;
  }
  50% {
    box-shadow:
      0 0 30px 8px currentColor,
      0 0 60px 15px currentColor;
  }
}

/* ===== GAME OVER SCREEN RETRO PIXEL ART STYLE ===== */
.game-over-modal {
  background-color: #000 !important;
  border: 4px solid #ffff00 !important;
  border-radius: 0 !important;
  box-shadow:
    0 0 0 4px #000,
    0 0 20px #ffff00,
    inset 0 0 20px rgba(255, 255, 0, 0.2) !important;
  font-family: 'Courier New', monospace !important;
}

.game-over-title {
  color: #ff0000 !important;
  text-shadow:
    3px 0 0 #ffff00,
    0 3px 0 #ffff00,
    -3px 0 0 #ffff00,
    0 -3px 0 #ffff00 !important;
  letter-spacing: 4px !important;
  font-weight: bold !important;
}

.game-over-score {
  color: #00ffff !important;
  text-shadow: 0 0 10px #00ffff !important;
}

.pixel-border {
  border: 2px solid #ffff00 !important;
  box-shadow:
    inset 2px 2px 0 0 #ffff00,
    inset -2px -2px 0 0 #ffff00 !important;
}

.pixel-button {
  background: #ffff00 !important;
  color: #000 !important;
  border: none !important;
  border-radius: 0 !important;
  box-shadow:
    4px 4px 0 0 #ff0000,
    inset 2px 2px 0 0 #ffffff !important;
  font-family: 'Courier New', monospace !important;
  font-weight: bold !important;
  letter-spacing: 2px !important;
  text-transform: uppercase !important;
  transition: all 0.1s !important;
}

.pixel-button:hover {
  transform: translate(2px, 2px) !important;
  box-shadow:
    2px 2px 0 0 #ff0000,
    inset 2px 2px 0 0 #ffffff !important;
}

.pixel-button:active {
  transform: translate(4px, 4px) !important;
  box-shadow: none !important;
}

.pixel-corner {
  width: 16px !important;
  height: 16px !important;
  border: 2px solid #ffff00 !important;
  background: #000 !important;
}

.pixel-corner-tl {
  border-right: none !important;
  border-bottom: none !important;
  top: -8px !important;
  left: -8px !important;
}

.pixel-corner-tr {
  border-left: none !important;
  border-bottom: none !important;
  top: -8px !important;
  right: -8px !important;
}

.pixel-corner-bl {
  border-right: none !important;
  border-top: none !important;
  bottom: -8px !important;
  left: -8px !important;
}

.pixel-corner-br {
  border-left: none !important;
  border-top: none !important;
  bottom: -8px !important;
  right: -8px !important;
}

.retro-stats-card {
  background: #111 !important;
  border: 2px solid #00ffff !important;
  box-shadow: 0 0 10px #00ffff !important;
}

@keyframes retro-pulse {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: 0.7;
  }
}

.retro-pulse {
  animation: retro-pulse 1s infinite !important;
}

/* Désactiver les transitions coûteuses sur mobile */
@media (max-width: 768px) {
  .pacman-container {
    transition-duration: 30ms !important;
  }
}

/* Optimisation pour les écrans haute densité */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  .wall-segment {
    /* Borders plus fins sur les écrans Retina pour éviter le flou */
    border-width: 0.5px;
  }
}
